# Messenger Application

Этот проект представляет собой полнофункциональное приложение-мессенджер, разработанное с использованием современных веб-технологий. Он включает в себя бэкенд на Node.js с Express и фронтенд на React.js с Material-UI, обеспечивая обмен сообщениями в реальном времени, аутентификацию пользователей и другие функции.

## Возможности

*   **Аутентификация и авторизация пользователей:** Регистрация, вход в систему, защита маршрутов с помощью JWT.
*   **Обмен сообщениями в реальном времени:** Использование WebSockets (Socket.IO) для мгновенной доставки сообщений.
*   **Управление чатами:** Создание, просмотр и участие в чатах.
*   **Загрузка файлов:** Возможность прикреплять файлы к сообщениям.
*   **Настройки конфиденциальности профиля:** Управление видимостью пользовательских данных.
*   **Поддержка нескольких баз данных:** Возможность использовать MongoDB (Mongoose) или SQL (Sequelize).
*   **Защита от спама/ботов:** Интеграция с Google reCAPTCHA.
*   **Уведомления по электронной почте:** Сервис для отправки системных уведомлений.

## Технологии

### Бэкенд (backend/)

*   **Node.js:** Среда выполнения JavaScript.
*   **Express.js:** Веб-фреймворк для Node.js.
*   **MongoDB (Mongoose):** Объектно-ориентированное моделирование данных (ORM) для MongoDB.
*   **Sequelize:** ORM для реляционных баз данных (например, PostgreSQL, MySQL).
*   **Socket.IO:** Библиотека для двунаправленной связи в реальном времени.
*   **JWT (JSON Web Tokens):** Для аутентификации и авторизации.
*   **Bcrypt.js:** Для хеширования паролей.
*   **Nodemailer:** Для отправки электронной почты.
*   **Multer:** Для обработки загрузки файлов.
*   **CORS, Helmet, Express Rate Limit:** Для безопасности и управления API.
*   **PM2:** Процесс-менеджер для производственных развертываний.

### Фронтенд (frontend/)

*   **React.js:** Библиотека JavaScript для построения пользовательских интерфейсов.
*   **Material-UI:** Библиотека компонентов React для быстрого и красивого дизайна.
*   **React Router DOM:** Для навигации по приложению.
*   **Axios:** HTTP-клиент для выполнения запросов к API.
*   **Socket.IO Client:** Клиентская библиотека для Socket.IO.
*   **React Google reCAPTCHA:** Компонент для интеграции reCAPTCHA.
*   **Date-fns:** Утилиты для работы с датами.
*   **Emoji-picker-react:** Компонент для выбора эмодзи.

### Инфраструктура

*   **Docker:** Для контейнеризации приложений.
*   **Docker Compose:** Для определения и запуска многоконтейнерных Docker-приложений.
*   **Nginx:** Высокопроизводительный веб-сервер (используется во фронтенд Dockerfile).

## Установка и запуск

Для запуска этого проекта у вас должны быть установлены Docker и Docker Compose.

1.  **Клонируйте репозиторий:**

    ```bash
    git clone <URL_ВАШЕГО_РЕПОЗИТОРИЯ>
    cd max
    ```

2.  **Настройка переменных окружения:**

    Создайте файл `.env` в корневой директории проекта и файл `.env` в директории `backend/` на основе файлов `.env.example`:

    *   `.env` (в корне проекта):
        ```
        # Пример:
        # MONGODB_URI=mongodb://localhost:27017/messenger
        # SQL_DATABASE_URI=postgres://user:password@host:port/database
        ```

    *   `backend/.env`:
        ```
        # Пример:
        # NODE_ENV=development
        # PORT=5000
        # JWT_SECRET=your_jwt_secret
        # EMAIL_SERVICE_USER=your_email@example.com
        # EMAIL_SERVICE_PASS=your_email_password
        # RECAPTCHA_SECRET_KEY=your_recaptcha_secret_key
        # DB_TYPE=mongo # или 'sql'
        ```

3.  **Запуск с Docker Compose:**

    В корневой директории проекта выполните:

    ```bash
    docker-compose up --build
    ```

    Это соберет образы Docker для бэкенда и фронтенда, а затем запустит контейнеры.

    *   Бэкенд будет доступен по адресу: `http://localhost:5000` (или на порту, указанном в `backend/.env`)
    *   Фронтенд будет доступен по адресу: `http://localhost:3000` (или на порту, настроенном в `nginx.conf`)

## Использование различных баз данных

Проект поддерживает как MongoDB, так и реляционные базы данных (через Sequelize).

*   **MongoDB:** Установите `DB_TYPE=mongo` в `backend/.env` и укажите `MONGODB_URI` в корневом `.env`.
*   **SQL (Sequelize):** Установите `DB_TYPE=sql` в `backend/.env` и укажите `SQL_DATABASE_URI` в корневом `.env`. Возможно, потребуется изменить или добавить миграции для создания схем базы данных.
    Для переключения на MongoDB, вы можете использовать скрипт:
    ```bash
    ./backend/switch-to-mongo.sh
    ```

## Скрипты Бэкенда

*   `npm start`: Запускает сервер Node.js.
*   `npm dev`: Запускает сервер Node.js с `nodemon` для автоматической перезагрузки при изменениях.

## Скрипты Фронтенда

*   `npm start`: Запускает приложение React в режиме разработки.
*   `npm build`: Собирает приложение React для продакшена.

## Структура Проекта

```
max/
├── .env.example
├── .gitignore
├── docker-compose.yml
├── README.md
├── backend/
│   ├── Dockerfile
│   ├── package.json
│   ├── server.js
│   ├── middleware/
│   ├── models/ (для MongoDB)
│   ├── models-sequelize/ (для SQL)
│   ├── routes/
│   ├── socket/
│   └── utils/
└── frontend/
    ├── Dockerfile
    ├── nginx.conf
    ├── package.json
    ├── public/
    └── src/
        ├── App.js
        ├── index.js
        ├── components/
        ├── context/
        └── utils/
```

## Вклад

Будем рады вашим вкладам! Пожалуйста, следуйте стандартному процессу Fork-Branch-Pull Request.

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности смотрите в файле LICENSE.md (если применимо).
